!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).DanmakuSender=n()}(this,function(){"use strict";function t(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function e(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}var u={uint32:function(e){return e>>>0}},n=function(){function i(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,i),i.createTable()}var e,n,r;return e=i,r=[{key:"createTable",value:function(){for(var e=0;e<256;e++){for(var n=u.uint32(e),r=0;r<8;r++)0!=(1&n)?n=u.uint32(this.CRCPOLYNOMIAL^n>>>1):n>>>=1;this.crctable[e]=n}}},{key:"crc32",value:function(e){for(var n=4294967295,r=0;r<e.length;r++)var t=u.uint32(255&(n^e.charCodeAt(r))),n=n>>>8^this.crctable[t];return n}},{key:"crc32LastIndex",value:function(e){for(var n=0,r=4294967295,t=0;t<e.length;t++)n=u.uint32(255&(r^e.charCodeAt(t))),r=r>>>8^this.crctable[n];return n}},{key:"getCrcIndex",value:function(e){for(var n=0;n<256;n++)if(this.crctable[n]>>>24===e)return n;return-1}},{key:"deepCheck",value:function(e,n){var r=new Array(2),t="",a=this.crc32(String(e)),e=u.uint32(255&a^n[2]);return e<=57&&48<=e?(t+=String(e-48),a=this.crctable[n[2]]^a>>>8,(e=u.uint32(255&a^n[1]))<=57&&48<=e?(t+=String(e-48),a=this.crctable[n[1]]^a>>>8,(e=u.uint32(255&a^n[0]))<=57&&48<=e?(t+=String(e-48),r[0]=1,r[1]=t):r[0]=0,r):(r[0]=0,r)):(r[0]=0,r)}}],(n=[{key:"parse",value:function(e){var n,r=new Array(2),t=new Array(4),a=u.uint32(parseInt("0x".concat(e),16));for(a^=4294967295,n=3;-1<n;n--)t[3-n]=i.getCrcIndex(a>>>8*n),a^=u.uint32(i.crctable[t[3-n]])>>>8*(3-n);for(n=0;n<1e9;n++){var c=u.uint32(i.crc32LastIndex(String(n)));if(c===t[3]&&0!==(r=i.deepCheck(n,t))[0])break}return 1e9===n?"-1":"".concat(n).concat(r[1])}}])&&t(e.prototype,n),r&&t(e,r),i}();return e(n,"CRCPOLYNOMIAL",3988292384),e(n,"crctable",new Array(256)),n});
